import { __decorate, __extends, __metadata, __param } from "tslib";
import { Directive, Inject, ElementRef } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { Directionality } from '@angular/cdk/bidi';
import { NgScrollbar } from '../../ng-scrollbar';
import { ThumbAdapter } from './thumb';
var ThumbXDirective = /** @class */ (function (_super) {
    __extends(ThumbXDirective, _super);
    function ThumbXDirective(cmp, element, document, dir) {
        var _this = _super.call(this, cmp, element.nativeElement, document) || this;
        _this.cmp = cmp;
        _this.element = element;
        _this.document = document;
        _this.dir = dir;
        return _this;
    }
    Object.defineProperty(ThumbXDirective.prototype, "clientProperty", {
        get: function () {
            return 'clientX';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "pageProperty", {
        get: function () {
            return 'pageX';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "viewportScrollSize", {
        get: function () {
            return this.cmp.viewport.scrollWidth;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "viewportScrollOffset", {
        get: function () {
            return this.cmp.viewport.scrollLeft;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "viewportScrollMax", {
        get: function () {
            return this.cmp.viewport.scrollMaxX;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "dragStartOffset", {
        get: function () {
            return this.clientRect.left;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbXDirective.prototype, "size", {
        get: function () {
            return this.thumbElement.clientWidth;
        },
        enumerable: true,
        configurable: true
    });
    ThumbXDirective.prototype.updateStyles = function (position, size) {
        this.thumbElement.style.width = size + "px";
        this.thumbElement.style.transform = "translate3d(" + position + "px, 0, 0)";
    };
    ThumbXDirective.prototype.handleDrag = function (position, scrollMax) {
        if (this.dir.value === 'rtl') {
            if (this.cmp.manager.rtlScrollAxisType === 1 /* NEGATED */) {
                return position - scrollMax;
            }
            if (this.cmp.manager.rtlScrollAxisType === 2 /* INVERTED */) {
                return scrollMax - position;
            }
            // Keeping this as a memo
            // if (this.rtlScrollAxisType === RtlScrollAxisType.NORMAL) {
            //   return position;
            // }
        }
        return position;
    };
    ThumbXDirective.prototype.handleDirection = function (position, trackMax) {
        if (this.dir.value === 'rtl') {
            if (this.cmp.manager.rtlScrollAxisType === 2 /* INVERTED */) {
                return -position;
            }
            if (this.cmp.manager.rtlScrollAxisType === 0 /* NORMAL */) {
                return position - trackMax;
            }
            // Keeping this as a memo
            // if (this.rtlScrollAxisType === RtlScrollAxisType.NEGATED) {
            //   return position;
            // }
        }
        return position;
    };
    ThumbXDirective.prototype.setDragging = function (value) {
        this.cmp.setDragging({ horizontalDragging: value });
    };
    ThumbXDirective.prototype.scrollTo = function (position) {
        this.cmp.viewport.scrollXTo(position);
    };
    ThumbXDirective.ctorParameters = function () { return [
        { type: NgScrollbar },
        { type: ElementRef },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
        { type: Directionality }
    ]; };
    ThumbXDirective = __decorate([
        Directive({ selector: '[scrollbarThumbX]' }),
        __param(2, Inject(DOCUMENT)),
        __metadata("design:paramtypes", [NgScrollbar,
            ElementRef, Object, Directionality])
    ], ThumbXDirective);
    return ThumbXDirective;
}(ThumbAdapter));
export { ThumbXDirective };
var ThumbYDirective = /** @class */ (function (_super) {
    __extends(ThumbYDirective, _super);
    function ThumbYDirective(cmp, element, document) {
        var _this = _super.call(this, cmp, element.nativeElement, document) || this;
        _this.cmp = cmp;
        _this.element = element;
        _this.document = document;
        return _this;
    }
    Object.defineProperty(ThumbYDirective.prototype, "pageProperty", {
        get: function () {
            return 'pageY';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "viewportScrollSize", {
        get: function () {
            return this.cmp.viewport.scrollHeight;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "viewportScrollOffset", {
        get: function () {
            return this.cmp.viewport.scrollTop;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "viewportScrollMax", {
        get: function () {
            return this.cmp.viewport.scrollMaxY;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "clientProperty", {
        get: function () {
            return 'clientY';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "dragStartOffset", {
        get: function () {
            return this.clientRect.top;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ThumbYDirective.prototype, "size", {
        get: function () {
            return this.thumbElement.clientHeight;
        },
        enumerable: true,
        configurable: true
    });
    ThumbYDirective.prototype.updateStyles = function (position, size) {
        this.thumbElement.style.height = size + "px";
        this.thumbElement.style.transform = "translate3d(0px, " + position + "px, 0)";
    };
    ThumbYDirective.prototype.handleDrag = function (position) {
        return position;
    };
    ThumbYDirective.prototype.handleDirection = function (position) {
        return position;
    };
    ThumbYDirective.prototype.setDragging = function (value) {
        this.cmp.setDragging({ verticalDragging: value });
    };
    ThumbYDirective.prototype.scrollTo = function (position) {
        this.cmp.viewport.scrollYTo(position);
    };
    ThumbYDirective.ctorParameters = function () { return [
        { type: NgScrollbar },
        { type: ElementRef },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
    ]; };
    ThumbYDirective = __decorate([
        Directive({ selector: '[scrollbarThumbY]' }),
        __param(2, Inject(DOCUMENT)),
        __metadata("design:paramtypes", [NgScrollbar,
            ElementRef, Object])
    ], ThumbYDirective);
    return ThumbYDirective;
}(ThumbAdapter));
export { ThumbYDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGh1bWIuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LXNjcm9sbGJhci8iLCJzb3VyY2VzIjpbImxpYi9zY3JvbGxiYXIvdGh1bWIvdGh1bWIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRTNDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDakQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUd2QztJQUFxQyxtQ0FBWTtJQThCL0MseUJBQXNCLEdBQWdCLEVBQ2hCLE9BQW1CLEVBQ0QsUUFBYSxFQUMvQixHQUFtQjtRQUh6QyxZQUlFLGtCQUFNLEdBQUcsRUFBRSxPQUFPLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxTQUM1QztRQUxxQixTQUFHLEdBQUgsR0FBRyxDQUFhO1FBQ2hCLGFBQU8sR0FBUCxPQUFPLENBQVk7UUFDRCxjQUFRLEdBQVIsUUFBUSxDQUFLO1FBQy9CLFNBQUcsR0FBSCxHQUFHLENBQWdCOztJQUV6QyxDQUFDO0lBakNELHNCQUFjLDJDQUFjO2FBQTVCO1lBQ0UsT0FBTyxTQUFTLENBQUM7UUFDbkIsQ0FBQzs7O09BQUE7SUFFRCxzQkFBYyx5Q0FBWTthQUExQjtZQUNFLE9BQU8sT0FBTyxDQUFDO1FBQ2pCLENBQUM7OztPQUFBO0lBRUQsc0JBQWMsK0NBQWtCO2FBQWhDO1lBQ0UsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUM7UUFDdkMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBYyxpREFBb0I7YUFBbEM7WUFDRSxPQUFPLElBQUksQ0FBQyxHQUFHLENB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QWUsR0FBekIsVUFBMEIsUUFBZ0I7UUFDeEMsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUVTLHFDQUFXLEdBQXJCLFVBQXNCLEtBQWM7UUFDbEMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFUyxrQ0FBUSxHQUFsQixVQUFtQixRQUFnQjtRQUNqQyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDeEMsQ0FBQzs7Z0JBMUIwQixXQUFXO2dCQUNQLFVBQVU7Z0RBQzVCLE1BQU0sU0FBQyxRQUFROztJQWhDakIsZUFBZTtRQUQzQixTQUFTLENBQUMsRUFBRSxRQUFRLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQztRQWlDOUIsV0FBQSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUE7eUNBRkYsV0FBVztZQUNQLFVBQVU7T0EvQjlCLGVBQWUsQ0F5RDNCO0lBQUQsc0JBQUM7Q0FBQSxBQXpERCxDQUFxQyxZQUFZLEdBeURoRDtTQXpEWSxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbmplY3QsIEVsZW1lbnRSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IFJ0bFNjcm9sbEF4aXNUeXBlIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3BsYXRmb3JtJztcbmltcG9ydCB7IERpcmVjdGlvbmFsaXR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xuaW1wb3J0IHsgTmdTY3JvbGxiYXIgfSBmcm9tICcuLi8uLi9uZy1zY3JvbGxiYXInO1xuaW1wb3J0IHsgVGh1bWJBZGFwdGVyIH0gZnJvbSAnLi90aHVtYic7XG5cbkBEaXJlY3RpdmUoeyBzZWxlY3RvcjogJ1tzY3JvbGxiYXJUaHVtYlhdJyB9KVxuZXhwb3J0IGNsYXNzIFRodW1iWERpcmVjdGl2ZSBleHRlbmRzIFRodW1iQWRhcHRlciB7XG5cbiAgcHJvdGVjdGVkIGdldCBjbGllbnRQcm9wZXJ0eSgpOiBzdHJpbmcge1xuICAgIHJldHVybiAnY2xpZW50WCc7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IHBhZ2VQcm9wZXJ0eSgpOiBzdHJpbmcge1xuICAgIHJldHVybiAncGFnZVgnO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldCB2aWV3cG9ydFNjcm9sbFNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jbXAudmlld3BvcnQuc2Nyb2xsV2lkdGg7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IHZpZXdwb3J0U2Nyb2xsT2Zmc2V0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbExlZnQ7XG4gIH1cblxuICBnZXQgdmlld3BvcnRTY3JvbGxNYXgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jbXAudmlld3BvcnQuc2Nyb2xsTWF4WDtcbiAgfVxuXG4gIGdldCBkcmFnU3RhcnRPZmZzZXQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jbGllbnRSZWN0LmxlZnQ7XG4gIH1cblxuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnRodW1iRWxlbWVudC5jbGllbnRXaWR0aDtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBjbXA6IE5nU2Nyb2xsYmFyLFxuICAgICAgICAgICAgICBwcm90ZWN0ZWQgZWxlbWVudDogRWxlbWVudFJlZixcbiAgICAgICAgICAgICAgQEluamVjdChET0NVTUVOVCkgcHJvdGVjdGVkIGRvY3VtZW50OiBhbnksXG4gICAgICAgICAgICAgIHByb3RlY3RlZCBkaXI6IERpcmVjdGlvbmFsaXR5KSB7XG4gICAgc3VwZXIoY21wLCBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQsIGRvY3VtZW50KTtcbiAgfVxuXG4gIHByb3RlY3RlZCB1cGRhdGVTdHlsZXMocG9zaXRpb246IG51bWJlciwgc2l6ZTogbnVtYmVyKSB7XG4gICAgdGhpcy50aHVtYkVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHtzaXplfXB4YDtcbiAgICB0aGlzLnRodW1iRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHtwb3NpdGlvbn1weCwgMCwgMClgO1xuICB9XG5cbiAgcHJvdGVjdGVkIGhhbmRsZURyYWcocG9zaXRpb246IG51bWJlciwgc2Nyb2xsTWF4OiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLmRpci52YWx1ZSA9PT0gJ3J0bCcpIHtcbiAgICAgIGlmICh0aGlzLmNtcC5tYW5hZ2VyLnJ0bFNjcm9sbEF4aXNUeXBlID09PSBSdGxTY3JvbGxBeGlzVHlwZS5ORUdBVEVEKSB7XG4gICAgICAgIHJldHVybiBwb3NpdGlvbiAtIHNjcm9sbE1heDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmNtcC5tYW5hZ2VyLnJ0bFNjcm9sbEF4aXNUeXBlID09PSBSdGxTY3JvbGxBeGlzVHlwZS5JTlZFUlRFRCkge1xuICAgICAgICByZXR1cm4gc2Nyb2xsTWF4IC0gcG9zaXRpb247XG4gICAgICB9XG4gICAgICAvLyBLZWVwaW5nIHRoaXMgYXMgYSBtZW1vXG4gICAgICAvLyBpZiAodGhpcy5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuTk9STUFMKSB7XG4gICAgICAvLyAgIHJldHVybiBwb3NpdGlvbjtcbiAgICAgIC8vIH1cbiAgICB9XG4gICAgcmV0dXJuIHBvc2l0aW9uO1xuICB9XG5cbiAgcHJvdGVjdGVkIGhhbmRsZURpcmVjdGlvbihwb3NpdGlvbjogbnVtYmVyLCB0cmFja01heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBpZiAodGhpcy5kaXIudmFsdWUgPT09ICdydGwnKSB7XG4gICAgICBpZiAodGhpcy5jbXAubWFuYWdlci5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuSU5WRVJURUQpIHtcbiAgICAgICAgcmV0dXJuIC1wb3NpdGlvbjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmNtcC5tYW5hZ2VyLnJ0bFNjcm9sbEF4aXNUeXBlID09PSBSdGxTY3JvbGxBeGlzVHlwZS5OT1JNQUwpIHtcbiAgICAgICAgcmV0dXJuIHBvc2l0aW9uIC0gdHJhY2tNYXg7XG4gICAgICB9XG4gICAgICAvLyBLZWVwaW5nIHRoaXMgYXMgYSBtZW1vXG4gICAgICAvLyBpZiAodGhpcy5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuTkVHQVRFRCkge1xuICAgICAgLy8gICByZXR1cm4gcG9zaXRpb247XG4gICAgICAvLyB9XG4gICAgfVxuICAgIHJldHVybiBwb3NpdGlvbjtcbiAgfVxuXG4gIHByb3RlY3RlZCBzZXREcmFnZ2luZyh2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuY21wLnNldERyYWdnaW5nKHsgaG9yaXpvbnRhbERyYWdnaW5nOiB2YWx1ZSB9KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBzY3JvbGxUbyhwb3NpdGlvbjogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5jbXAudmlld3BvcnQuc2Nyb2xsWFRvKHBvc2l0aW9uKTtcbiAgfVxufVxuXG5ARGlyZWN0aXZlKHsgc2VsZWN0b3I6ICdbc2Nyb2xsYmFyVGh1bWJZXScgfSlcbmV4cG9ydCBjbGFzcyBUaHVtYllEaXJlY3RpdmUgZXh0ZW5kcyBUaHVtYkFkYXB0ZXIge1xuXG4gIHByb3RlY3RlZCBnZXQgcGFnZVByb3BlcnR5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICdwYWdlWSc7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IHZpZXdwb3J0U2Nyb2xsU2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxIZWlnaHQ7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0IHZpZXdwb3J0U2Nyb2xsT2Zmc2V0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbFRvcDtcbiAgfVxuXG4gIGdldCB2aWV3cG9ydFNjcm9sbE1heCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxNYXhZO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldCBjbGllbnRQcm9wZXJ0eSgpOiBzdHJpbmcge1xuICAgIHJldHVybiAnY2xpZW50WSc7XG4gIH1cblxuICBnZXQgZHJhZ1N0YXJ0T2Zmc2V0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY2xpZW50UmVjdC50b3A7XG4gIH1cblxuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnRodW1iRWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY21wOiBOZ1Njcm9sbGJhcixcbiAgICAgICAgICAgICAgcHJvdGVjdGVkIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgICAgICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHByb3RlY3RlZCBkb2N1bWVudDogYW55KSB7XG4gICAgc3VwZXIoY21wLCBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQsIGRvY3VtZW50KTtcbiAgfVxuXG5cbiAgcHJvdGVjdGVkIHVwZGF0ZVN0eWxlcyhwb3NpdGlvbjogbnVtYmVyLCBzaXplOiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnRodW1iRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtzaXplfXB4YDtcbiAgICB0aGlzLnRodW1iRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoMHB4LCAke3Bvc2l0aW9ufXB4LCAwKWA7XG4gIH1cblxuICBwcm90ZWN0ZWQgaGFuZGxlRHJhZyhwb3NpdGlvbjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcG9zaXRpb247XG4gIH1cblxuICBwcm90ZWN0ZWQgaGFuZGxlRGlyZWN0aW9uKHBvc2l0aW9uOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBwb3NpdGlvbjtcbiAgfVxuXG4gIHByb3RlY3RlZCBzZXREcmFnZ2luZyh2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuY21wLnNldERyYWdnaW5nKHsgdmVydGljYWxEcmFnZ2luZzogdmFsdWUgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgc2Nyb2xsVG8ocG9zaXRpb246IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbFlUbyhwb3NpdGlvbik7XG4gIH1cbn1cbiJdfQ==